webpackJsonp([1],{0:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(170),_reactDom2=_interopRequireDefault(_reactDom),_reactCookie=__webpack_require__(169),_reactCookie2=_interopRequireDefault(_reactCookie),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__(19),_underscore2=_interopRequireDefault(_underscore),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),_calendarBody=__webpack_require__(197),_calendarBody2=_interopRequireDefault(_calendarBody),_calendarSidebar=__webpack_require__(206),_calendarSidebar2=_interopRequireDefault(_calendarSidebar),_calendarDetail=__webpack_require__(201),_calendarDetail2=_interopRequireDefault(_calendarDetail),_calendarCreate=__webpack_require__(199),_calendarCreate2=_interopRequireDefault(_calendarCreate),Calendar=function(_React$Component){function Calendar(props){_classCallCheck(this,Calendar);var _this=_possibleConstructorReturn(this,(Calendar.__proto__||Object.getPrototypeOf(Calendar)).call(this,props)),now=(0,_moment2.default)(),cookieView=_reactCookie2.default.load("view")||"weekly",cookieFilter=_reactCookie2.default.load("catFilter")||[];return now.position=0,_this.state={date:now,view:cookieView,events:[],queue:[],popup:{a:!1,p:!1},user:!1,message:{a:!1,m:!1,o:!1},loading:!1,detail:!1,catFilter:cookieFilter,categories:[]},_this.fetchCategories=_this.fetchCategories.bind(_this),_this.fetchEvents=_this.fetchEvents.bind(_this),_this.refreshEvents=_this.refreshEvents.bind(_this),_this.handleEventChange=_this.handleEventChange.bind(_this),_this.handleDate=_this.handleDate.bind(_this),_this.handlePopup=_this.handlePopup.bind(_this),_this.handleDetail=_this.handleDetail.bind(_this),_this.cancelPopup=_this.cancelPopup.bind(_this),_this.cancelPopupClick=_this.cancelPopupClick.bind(_this),_this.cancelMessage=_this.cancelMessage.bind(_this),_this.preventCancelPopup=_this.preventCancelPopup.bind(_this),_this.toggleFilter=_this.toggleFilter.bind(_this),_this.viewToggle=_this.viewToggle.bind(_this),_this}return _inherits(Calendar,_React$Component),_createClass(Calendar,[{key:"componentDidMount",value:function(){var now=(0,_moment2.default)();this.fetchCategories(),this.handleDate(now),"weekly"==this.state.view?document.title=(0,_moment2.default)(this.state.date).startOf("isoWeek").format("D")+"–"+(0,_moment2.default)(this.state.date).endOf("isoWeek").format("D MMMM YYYY")+" ‹ Calendar – Humphrey":"monthly"==this.state.view&&(document.title=(0,_moment2.default)(this.state.date).format("MMMM YYYY")+" ‹ Calendar – Humphrey")}},{key:"fetchCategories",value:function(){var _this2=this,x=this.state.categories.length;_jquery2.default.ajax({method:"GET",url:document.baseURI+"/events/?categories=1",dataType:"json"}).done(function(categoryList){var catList=_underscore2.default.sortBy(categoryList,"name");_this2.setState({categories:catList},function(){x>0&&_this2.fetchEvents(_this2.state.date,function(newEvents){_this2.setState({loading:!1,events:newEvents})})})})}},{key:"fetchEvents",value:function(week,callback){var start=(0,_moment2.default)(week).startOf("isoWeek").format("X"),end=(0,_moment2.default)(week).endOf("isoWeek").format("X"),catFilter=this.state.catFilter;"monthly"==this.state.view&&(start=(0,_moment2.default)(week).startOf("month").subtract(15,"days").format("X"),end=(0,_moment2.default)(week).endOf("month").add(15,"days").format("X")),this.setState({loading:!0},function(){_jquery2.default.ajax({method:"GET",url:document.baseURI+"/events/?start="+start+"&end="+end,dataType:"json"}).done(function(data){Array.isArray(data)?(setTimeout(function(){data.forEach(function(ev){ev.visible=!0,catFilter.length>0&&catFilter.indexOf(ev.category._id)==-1&&(ev.visible=!1),ev.allday?(ev.start=(0,_moment2.default)(ev.start,"X"),ev.end&&(ev.end=(0,_moment2.default)(ev.end,"X"))):(ev.start=(0,_moment2.default)(ev.start,"X").subtract(2,"hours"),ev.end&&(ev.end=(0,_moment2.default)(ev.end,"X").subtract(2,"hours")))})},100),setTimeout(function(){callback(data)},300)):setTimeout(function(){callback([])},300)})})}},{key:"refreshEvents",value:function(e){var _this3=this;e.preventDefault(),this.fetchEvents(this.state.date,function(newEvents){_this3.cancelMessage(),_this3.setState({loading:!1,events:newEvents})})}},{key:"handleEventChange",value:function(ev){var _this4=this;this.state.events;this.fetchEvents(this.state.date,function(newEvents){_this4.setState({loading:!1,events:newEvents})})}},{key:"handleDate",value:function(newDate){var _this5=this;"weekly"==this.state.view&&1==(0,_moment2.default)(newDate).isoWeekday()&&(newDate=(0,_moment2.default)(newDate).add(1,"days")),this.fetchEvents(newDate,function(newEvents){_this5.setState({loading:!1,date:newDate,events:newEvents},function(){"weekly"==_this5.state.view?document.title=(0,_moment2.default)(newDate).startOf("isoWeek").format("D")+"–"+(0,_moment2.default)(newDate).endOf("isoWeek").format("D MMMM YYYY")+" ‹ Calendar – Humphrey":"monthly"==_this5.state.view&&(document.title=(0,_moment2.default)(newDate).format("MMMM YYYY")+" ‹ Calendar – Humphrey")})})}},{key:"handlePopup",value:function(arg){this.setState({popup:{a:!0,p:arg}})}},{key:"handleDetail",value:function(arg){this.setState({detail:arg})}},{key:"cancelPopup",value:function(){var _this6=this,popup=this.state.popup;popup.a=!1,this.setState({popup:popup},function(){setTimeout(function(){popup.p=!1,_this6.setState({popup:popup},function(){"success"!=_this6.state.message.o&&_this6.cancelMessage()})},1)})}},{key:"cancelPopupClick",value:function(e){var _this7=this;e.preventDefault();var popup=this.state.popup;"calendar-jacket"!=e.target.id&&"close-popup"!=e.target.id||(popup.a=!1,this.setState({popup:popup},function(){setTimeout(function(){popup.p=!1,_this7.setState({popup:popup,detail:!1},function(){"success"!=_this7.state.message.o&&_this7.cancelMessage()})},251)}))}},{key:"cancelMessage",value:function(e){var _this8=this;e&&e.preventDefault();var message=this.state.message;message.a=!1,this.setState({message:message},function(){setTimeout(function(){message.m=!1,message.o=!1,_this8.setState({message:message,queue:[]})},251)})}},{key:"preventCancelPopup",value:function(e){e.preventDefault()}},{key:"toggleFilter",value:function(arg){var cat=Number(arg),catFilter=this.state.catFilter,events=this.state.events,catIndex=catFilter.indexOf(cat);catIndex>-1&&catFilter.splice(catIndex,1),catIndex==-1&&catFilter.push(cat),"clear"==arg&&(catFilter=[]),events.forEach(function(ev){ev.visible=!0,catFilter.length>0&&catFilter.indexOf(ev.category._id)==-1&&(ev.visible=!1)}),this.setState({catFilter:catFilter,events:events},function(){_reactCookie2.default.save("catFilter",catFilter)})}},{key:"viewToggle",value:function(e){var _this9=this;e.preventDefault();var date=this.state.date,newView="weekly";"weekly"==this.state.view&&(newView="monthly"),this.setState({view:newView},function(){_this9.handleDate(date),_reactCookie2.default.save("view",newView)})}},{key:"render",value:function(){var CalendarPopup=void 0;"detail"==this.state.popup.p&&(CalendarPopup=_react2.default.createElement(_calendarDetail2.default,{user:this.state.user,detail:this.state.detail,categories:this.state.categories,cancelPopup:this.cancelPopup,updateEvent:this.handleEventChange})),"create"==this.state.popup.p&&(CalendarPopup=_react2.default.createElement(_calendarCreate2.default,{user:this.state.user,cancelPopup:this.cancelPopup,categories:this.state.categories,newEvent:this.handleEventChange}));var CalendarMessage,messageClasses="calendar-message ";return this.state.message.m&&(CalendarMessage=_react2.default.createElement("span",null,_react2.default.createElement("span",{className:"content"},this.state.message.m),_react2.default.createElement("a",{href:"",className:"close",onClick:this.cancelMessage},"×")),messageClasses+=this.state.message.o),_react2.default.createElement("div",{id:"calendar-wrapper",className:this.state.message.a?"message":""},_react2.default.createElement(_calendarSidebar2.default,{date:this.state.date,view:this.state.view,catFilter:this.state.catFilter,categories:this.state.categories,toggleFilter:this.toggleFilter,setDate:this.handleDate,viewToggle:this.viewToggle}),_react2.default.createElement(_calendarBody2.default,{date:this.state.date,view:this.state.view,events:this.state.events,loading:this.state.loading,user:this.state.user,setDate:this.handleDate,setPopup:this.handlePopup,setDetail:this.handleDetail}),_react2.default.createElement("div",{id:"calendar-jacket",onClick:this.cancelPopupClick,className:this.state.popup.a?"active":""},_react2.default.createElement("div",{className:"calendar-popup "+this.state.popup.p,onClick:this.preventCancelPopup},CalendarPopup)),_react2.default.createElement("div",{className:this.state.message.a?messageClasses+" active":messageClasses},CalendarMessage))}}]),Calendar}(_react2.default.Component);_reactDom2.default.render(_react2.default.createElement(Calendar,null),document.getElementById("calendar"))},197:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_calendarControls=__webpack_require__(198),_calendarControls2=_interopRequireDefault(_calendarControls),_calendarMonthly=__webpack_require__(205),_calendarMonthly2=_interopRequireDefault(_calendarMonthly),_calendarStretch=__webpack_require__(207),_calendarStretch2=_interopRequireDefault(_calendarStretch),CalendarBody=function(_React$Component){function CalendarBody(){return _classCallCheck(this,CalendarBody),_possibleConstructorReturn(this,(CalendarBody.__proto__||Object.getPrototypeOf(CalendarBody)).apply(this,arguments))}return _inherits(CalendarBody,_React$Component),_createClass(CalendarBody,[{key:"render",value:function(){var CalendarPeriod=void 0;return"weekly"==this.props.view?CalendarPeriod=_react2.default.createElement(_calendarStretch2.default,{loading:this.props.loading,date:this.props.date,events:this.props.events,setPopup:this.props.setPopup,setDetail:this.props.setDetail}):"monthly"==this.props.view&&(CalendarPeriod=_react2.default.createElement(_calendarMonthly2.default,{loading:this.props.loading,date:this.props.date,events:this.props.events,setPopup:this.props.setPopup,setDetail:this.props.setDetail})),_react2.default.createElement("section",{id:"calendar-body"},_react2.default.createElement(_calendarControls2.default,{date:this.props.date,view:this.props.view,user:this.props.user,setDate:this.props.setDate,setPopup:this.props.setPopup,handleAuth:this.props.handleAuth}),CalendarPeriod)}}]),CalendarBody}(_react2.default.Component);exports.default=CalendarBody},198:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),CalendarControls=function(_React$Component){function CalendarControls(props){_classCallCheck(this,CalendarControls);var _this=_possibleConstructorReturn(this,(CalendarControls.__proto__||Object.getPrototypeOf(CalendarControls)).call(this,props));return _this.setDate=_this.setDate.bind(_this),_this.setPopup=_this.setPopup.bind(_this),_this.handleLogout=_this.handleLogout.bind(_this),_this}return _inherits(CalendarControls,_React$Component),_createClass(CalendarControls,[{key:"setDate",value:function(e){e.preventDefault(),this.props.setDate((0,_moment2.default)(e.target.dataset.date,"YYYY-MM-DD"))}},{key:"setPopup",value:function(e){e.preventDefault(),this.props.setPopup(e.target.dataset.arg)}},{key:"handleLogout",value:function(e){e.preventDefault(),this.props.handleAuth("logout")}},{key:"render",value:function(){var now=(0,_moment2.default)().format("YYYY-MM-DD"),loginButton=void 0,createButton=void 0,settingsButton=void 0,periodTitle=void 0,periodNum=void 0,periodNav=void 0,styles=void 0;if("weekly"==this.props.view){var startWeek=(0,_moment2.default)(this.props.date).startOf("isoWeek"),_next=(0,_moment2.default)(this.props.date).add(7,"days").format("YYYY-MM-DD"),_prev=(0,_moment2.default)(this.props.date).subtract(7,"days").format("YYYY-MM-DD");periodTitle=_react2.default.createElement("h1",null,(0,_moment2.default)(this.props.date).startOf("isoWeek").format("D")+" – "+(0,_moment2.default)(this.props.date).endOf("isoWeek").format("D MMM YYYY")),periodNum=_react2.default.createElement("span",{className:"weekly-num",title:"Week "+(0,_moment2.default)(this.props.date).format("W")},_react2.default.createElement("strong",null,(0,_moment2.default)(this.props.date).format("W"))),periodNav=_react2.default.createElement("div",null,_react2.default.createElement("a",{href:"",onClick:this.setDate,className:"material-icons prev","data-date":_prev,title:"Go to week "+(0,_moment2.default)(this.props.date).subtract(1,"weeks").format("W")},"arrow_back"),periodTitle," ",periodNum,_react2.default.createElement("a",{href:"",onClick:this.setDate,className:"material-icons next","data-date":_next,title:"Go to week "+(0,_moment2.default)(this.props.date).add(1,"weeks").format("W")},"arrow_forward")),(0,_moment2.default)().startOf("isoWeek").isSame(startWeek,"week")&&(styles={display:"none"})}else if("monthly"==this.props.view){var _next2=(0,_moment2.default)(this.props.date).add(1,"months").format("YYYY-MM-DD"),_prev2=(0,_moment2.default)(this.props.date).subtract(1,"months").format("YYYY-MM-DD");periodTitle=_react2.default.createElement("h1",null,(0,_moment2.default)(this.props.date).format("MMMM YYYY")),periodNav=_react2.default.createElement("nav",{className:"weekly-nav"},_react2.default.createElement("a",{href:"",onClick:this.setDate,className:"material-icons prev","data-date":_prev2,title:"Go to "+(0,_moment2.default)(this.props.date).subtract(1,"months").format("MMMM YYYY")},"arrow_back"),periodTitle," ",periodNum,_react2.default.createElement("a",{href:"",onClick:this.setDate,className:"material-icons next","data-date":_next2,title:"Go to "+(0,_moment2.default)(this.props.date).add(1,"months").format("MMMM YYYY")},"arrow_forward")),(0,_moment2.default)().isSame(this.props.date,"month")&&(styles={display:"none"})}return this.props.user||(loginButton=_react2.default.createElement("a",{href:"",className:"button",onClick:this.setPopup,"data-arg":"login"},"Login")),this.props.user&&(loginButton=_react2.default.createElement("a",{href:"",className:"button",onClick:this.handleLogout},"Logout")),(0,_jquery2.default)("#header-user").hasClass("publisher")&&(createButton=_react2.default.createElement("a",{href:"",className:"button",onClick:this.setPopup,"data-arg":"create"},"Add event")),_react2.default.createElement("header",{id:"calendar-controls"},_react2.default.createElement("nav",{className:"weekly-nav"},periodNav),_react2.default.createElement("div",{className:"weekly-options"},_react2.default.createElement("a",{href:"",className:"button today",onClick:this.setDate,"data-date":now,style:styles},"Today"),createButton,settingsButton))}}]),CalendarControls}(_react2.default.Component);exports.default=CalendarControls},199:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_fullcalendar=__webpack_require__(24),CalendarCreate=(_interopRequireDefault(_fullcalendar),function(_React$Component){function CalendarCreate(props){_classCallCheck(this,CalendarCreate);var _this=_possibleConstructorReturn(this,(CalendarCreate.__proto__||Object.getPrototypeOf(CalendarCreate)).call(this,props));return _this.state={title:"",start:(0,_moment2.default)(),end:"",allday:!0,multiday:!1,category:"",recursion:"once",note:"",loading:!1},_this.setDate=_this.setDate.bind(_this),_this.handleChange=_this.handleChange.bind(_this),_this.handleCheckbox=_this.handleCheckbox.bind(_this),_this.handleTime=_this.handleTime.bind(_this),_this.handleEndTime=_this.handleEndTime.bind(_this),_this.handleSubmit=_this.handleSubmit.bind(_this),_this}return _inherits(CalendarCreate,_React$Component),_createClass(CalendarCreate,[{key:"componentDidMount",value:function(){var that=this;(0,_jquery2.default)(".calendar-popupcal").fullCalendar({firstDay:1,header:{left:"",center:"prev title next",right:""},buttonIcons:!1,buttonText:{prev:"‹",next:"›"},dayNamesShort:["S","M","T","W","T","F","S"],dayRender:function(date,cell){(0,_jquery2.default)(cell).html("<span>"+(0,_moment2.default)(date).format("D")+"</span>"),that.state.multiday?((0,_moment2.default)(date).isSame(that.state.start,"day")&&(0,_jquery2.default)(cell).addClass("selected start"),(0,_moment2.default)(date).isSame(that.state.end,"day")&&(0,_jquery2.default)(cell).addClass("selected end"),(0,_moment2.default)(date).isBetween(that.state.start,that.state.end)&&(0,_jquery2.default)(cell).addClass("selected")):(0,_moment2.default)(that.state.start).isSame(date,"day")&&that.setDate(date)},dayClick:function(date,jsEvent,view){that.setDate(date)}})}},{key:"setDate",value:function(date){function drawRange(start,end){for(var num=end.diff(start,"days"),i=0;i<=num;i++)(0,_jquery2.default)(".fc-day[data-date="+(0,_moment2.default)(start).add(i,"days").format("YYYY-MM-DD")+"]").addClass("selected"),0==i&&(0,_jquery2.default)(".fc-day[data-date="+(0,_moment2.default)(start).add(i,"days").format("YYYY-MM-DD")+"]").addClass("start"),i==num&&(0,_jquery2.default)(".fc-day[data-date="+(0,_moment2.default)(start).add(i,"days").format("YYYY-MM-DD")+"]").addClass("end")}var _this2=this;(0,_jquery2.default)(".fc-day").removeClass("selected start end"),this.state.multiday?(0,_moment2.default)(date).isBefore(this.state.start)?""!=this.state.end?this.setState({start:(0,_moment2.default)(date)},function(){drawRange(_this2.state.start,_this2.state.end)}):this.setState({start:(0,_moment2.default)(date),end:this.state.start},function(){drawRange(_this2.state.start,_this2.state.end)}):(0,_moment2.default)(date).isBetween(this.state.start,this.state.end)?this.setState({start:(0,_moment2.default)(date)},function(){drawRange(_this2.state.start,_this2.state.end)}):(0,_moment2.default)(date).isAfter(this.state.start)&&this.setState({end:(0,_moment2.default)(date)},function(){drawRange(_this2.state.start,_this2.state.end)}):((0,_jquery2.default)(".fc-day[data-date="+(0,_moment2.default)(date).format("YYYY-MM-DD")+"]").addClass("selected start end"),this.setState({start:(0,_moment2.default)(date),end:""}))}},{key:"handleChange",value:function(e){var obj={};obj[e.target.name]=e.target.value,this.setState(obj)}},{key:"handleCheckbox",value:function(e){var _this3=this,obj={};(0,_jquery2.default)(e.target).hasClass("active")?obj[e.target.dataset.arg]=!1:obj[e.target.dataset.arg]=!0,1!=obj.multiday&&1!=this.state.multiday||(obj.allday=!0),0!=obj.multiday&&0!=this.state.multiday||(obj.end=""),1==obj.allday&&(obj.start=(0,_moment2.default)(this.state.start).set({hour:0,minute:0})),this.setState(obj,function(){0==obj.multiday&&_this3.setDate(_this3.state.start)})}},{key:"handleTime",value:function(e){var start=(0,_moment2.default)(this.state.start),end="",time=Number(e.target.value);return""!=this.state.end&&(end=(0,_moment2.default)(this.state.end)),"start-hours"==e.target.dataset.arg&&(start=(0,_moment2.default)(start).set("hour",time)),"start-minutes"==e.target.dataset.arg&&(start=(0,_moment2.default)(start).set("minute",time)),"end-hours"==e.target.dataset.arg&&(end=(0,_moment2.default)(end).set("hour",time)),"end-minutes"==e.target.dataset.arg&&(end=(0,_moment2.default)(end).set("minute",time)),(0,_moment2.default)(end).isBefore(start)?alert("Invalid time"):void this.setState({start:start,end:end})}},{key:"handleEndTime",value:function(e){var start=this.state.start;""==this.state.end&&0==this.state.allday?this.setState({end:(0,_moment2.default)(start).add(1,"hours")}):this.setState({end:""})}},{key:"handleSubmit",value:function(e){var _this4=this;return e.preventDefault(),""==this.state.title?alert("Please enter a title"):""==this.state.category?alert("Please supply a category"):void this.setState({loading:!0},function(){var ev=_this4.state;ev.start=(0,_moment2.default)(ev.start).format("X"),ev.end&&(ev.end=(0,_moment2.default)(ev.end).format("X")),ev.reason="create",_jquery2.default.ajax({method:"POST",url:document.baseURI+"/events",data:ev,dataType:"json"}).done(function(response){_this4.setState({loading:!1},function(){_this4.props.cancelPopup(),_this4.props.newEvent(response)})})})}},{key:"render",value:function(){var ev=this.state,hours=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],minutes=["00","05","10","15","20","25","30","35","40","45","50","55"],startHourList=hours.map(function(hour){return _react2.default.createElement("option",{value:hour,key:"sh-"+hour},hour)}),startMinuteList=minutes.map(function(minute){return _react2.default.createElement("option",{value:minute,key:"sm-"+minute},minute)}),endHourList=hours.map(function(hour){if(hour>=(0,_moment2.default)(ev.start).format("HH"))return _react2.default.createElement("option",{value:hour,key:"eh-"+hour},hour)}),endMinuteList=minutes.map(function(minute){return _react2.default.createElement("option",{value:minute,key:"em-"+minute},minute)}),catList=this.props.categories.map(function(cat){return _react2.default.createElement("option",{value:cat.id,key:cat.id},cat.name)});return _react2.default.createElement("div",{id:"calendar-create"},_react2.default.createElement("header",{className:"popup-header"},_react2.default.createElement("div",{className:"active"},"Add"),_react2.default.createElement("div",{id:"close-popup",onClick:this.props.cancelPopup},"×")),_react2.default.createElement("div",{className:"popup-body"},_react2.default.createElement("form",null,_react2.default.createElement("div",{className:"form-row"},_react2.default.createElement("label",{htmlFor:"create-title"},"Title"),_react2.default.createElement("input",{type:"text",id:"create-title",name:"title",value:ev.title,onChange:this.handleChange})),_react2.default.createElement("div",{className:"form-row"},_react2.default.createElement("label",{htmlFor:"create-date"},"Date"),_react2.default.createElement("div",{className:"calendar"},_react2.default.createElement("div",{className:"calendar-popupcal"}),_react2.default.createElement("div",{className:"calendar-options"},_react2.default.createElement("label",{className:ev.allday?"checkbox active":"checkbox","data-arg":"allday",onClick:this.handleCheckbox},"All day"),_react2.default.createElement("label",{className:ev.multiday?"checkbox active":"checkbox","data-arg":"multiday",onClick:this.handleCheckbox},"Date range"),_react2.default.createElement("label",{className:ev.allday?"create-time disabled":"create-time",htmlFor:"create-time-start-hours"},"Start time"),_react2.default.createElement("div",{className:"set-time"},_react2.default.createElement("select",{id:"create-time-start-hours",onChange:this.handleTime,value:(0,_moment2.default)(ev.start).format("HH"),disabled:ev.allday,"data-arg":"start-hours"},startHourList),_react2.default.createElement("select",{id:"create-time-start-minutes",onChange:this.handleTime,value:(0,_moment2.default)(ev.start).format("mm"),disabled:ev.allday,"data-arg":"start-minutes"},startMinuteList)),_react2.default.createElement("label",{className:ev.allday?"checkbox disabled":""!=ev.end?"checkbox active":"checkbox",htmlFor:"create-time-end-hours",onClick:this.handleEndTime},"End time"),_react2.default.createElement("div",{className:"set-time"},_react2.default.createElement("select",{id:"create-time-end-hours",onChange:this.handleTime,value:(0,_moment2.default)(ev.end).format("HH"),disabled:1==ev.allday||""==ev.end,"data-arg":"end-hours"},endHourList),_react2.default.createElement("select",{id:"create-time-end-minutes",onChange:this.handleTime,value:(0,_moment2.default)(ev.end).format("mm"),disabled:1==ev.allday||""==ev.end,"data-arg":"end-minutes"},endMinuteList)),_react2.default.createElement("label",{className:"create-time",htmlFor:"create-recursion"},"Recursion"),_react2.default.createElement("div",{className:"set-time"},_react2.default.createElement("select",{id:"create-recursion",name:"recursion",value:ev.recursion,onChange:this.handleChange},_react2.default.createElement("option",{value:"once"},"Once"),_react2.default.createElement("option",{value:"monthly"},"Monthly"),_react2.default.createElement("option",{value:"yearly"},"Yearly")))))),_react2.default.createElement("div",{className:"form-row"},_react2.default.createElement("label",{htmlFor:"create-category"},"Category"),_react2.default.createElement("select",{id:"create-category",name:"category",value:ev.category,onChange:this.handleChange},_react2.default.createElement("option",{value:"",key:"empty-cat"}," "),catList)),_react2.default.createElement("div",{className:"form-row"},_react2.default.createElement("label",{htmlFor:"create-note"},"Note"),_react2.default.createElement("textarea",{id:"create-note",name:"note",value:ev.note,onChange:this.handleChange})),_react2.default.createElement("button",{className:"button",type:"submit",onClick:this.handleSubmit},"Create"))),_react2.default.createElement("div",{className:this.state.loading?"loading active":"loading"},_react2.default.createElement("div",{className:"spinner"})))}}]),CalendarCreate}(_react2.default.Component));exports.default=CalendarCreate},200:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{
constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__(19),_underscore2=_interopRequireDefault(_underscore),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),CalendarDay=function(_React$Component){function CalendarDay(props){_classCallCheck(this,CalendarDay);var _this=_possibleConstructorReturn(this,(CalendarDay.__proto__||Object.getPrototypeOf(CalendarDay)).call(this,props));return _this.clickDay=_this.clickDay.bind(_this),_this.clickEvent=_this.clickEvent.bind(_this),_this.mouseEnterEvent=_this.mouseEnterEvent.bind(_this),_this.mouseLeaveEvent=_this.mouseLeaveEvent.bind(_this),_this}return _inherits(CalendarDay,_React$Component),_createClass(CalendarDay,[{key:"clickDay",value:function(e){(0,_jquery2.default)(".day, .event").removeClass("active"),(0,_jquery2.default)(".day[data-date="+e.target.dataset.date+"], .event[data-date="+e.target.dataset.date+"]").addClass("active")}},{key:"clickEvent",value:function(e){(0,_jquery2.default)(".day, .event").removeClass("active"),(0,_jquery2.default)(".day[data-date="+e.target.dataset.date+"], .event[data-date="+e.target.dataset.date+"]").addClass("active"),this.props.setPopup("detail"),this.props.setDetail(e.target.dataset.eventid)}},{key:"mouseEnterEvent",value:function(e){(0,_jquery2.default)(".event.event-"+e.target.dataset.eventid).addClass("hover")}},{key:"mouseLeaveEvent",value:function(e){(0,_jquery2.default)(".event").removeClass("hover")}},{key:"render",value:function(){var _this2=this,now=(0,_moment2.default)(),dataset=this.props.dataset,dayNumber=void 0;if("wkd"==dataset.weekday){var num=Number((0,_moment2.default)(dataset.start).format("D"));dayNumber=_react2.default.createElement("span",{className:"sat-sun"},_react2.default.createElement("span",{className:"saturday"},num),_react2.default.createElement("span",{className:"seperator"},"/"),_react2.default.createElement("span",{className:"sunday"},num+1))}else dayNumber=_react2.default.createElement("span",{className:"workday"},(0,_moment2.default)(dataset.start).format("D"));dataset.alldays=_underscore2.default.sortBy(dataset.alldays,"pos");var alldays=dataset.alldays.map(function(ev,index){var style={backgroundColor:ev.category.color};style.top=25*ev.pos;var classes="event event-"+ev._id;return(0,_moment2.default)(ev.start).isBefore(dataset.start)&&(classes+=" yesterday"),ev.end&&(0,_moment2.default)(ev.end).isAfter(dataset.end)&&(classes+=" tomorrow"),_react2.default.createElement("li",{className:classes,style:style,key:ev._id+(0,_moment2.default)(ev.start).format(),title:ev.title,onMouseEnter:_this2.mouseEnterEvent,onMouseLeave:_this2.mouseLeaveEvent,onClick:_this2.clickEvent,"data-eventid":ev._id,"data-date":(0,_moment2.default)(dataset.start).format("YYYY-MM-DD")},_react2.default.createElement("span",{className:"event-title"},ev.title))}),highestAllday=_underscore2.default.max(dataset.alldays,function(ev){return ev.pos}),alldaysHeight={height:25*((Number(highestAllday.pos)||0)+1)+5},singles=dataset.singles.map(function(ev,index){var time=_react2.default.createElement("time",{className:"event-time",dateTime:ev.start},(0,_moment2.default)(ev.start).format("HH:mm"));ev.end&&(time=_react2.default.createElement("time",{className:"event-time",dateTime:ev.start},(0,_moment2.default)(ev.start).format("HH:mm")," – ",(0,_moment2.default)(ev.end).format("HH:mm")));var weekendDay="";return"wkd"==dataset.weekday&&(weekendDay=_react2.default.createElement("span",{className:"event-weekend"},(0,_moment2.default)(ev.start).format("ddd"))),_react2.default.createElement("li",{className:"event",key:ev._id+(0,_moment2.default)(ev.start).format(),title:ev.title,onClick:_this2.clickEvent,"data-eventid":ev._id,"data-date":(0,_moment2.default)(dataset.start).format("YYYY-MM-DD")},_react2.default.createElement("i",{style:{backgroundColor:ev.category.color}}),time,weekendDay,_react2.default.createElement("span",{className:"event-title"},ev.title))});return _react2.default.createElement("li",{className:(0,_moment2.default)(now).isBetween(dataset.start,dataset.end)?"today active day "+dataset.weekday:"day "+dataset.weekday,onClick:this.clickDay,"data-date":(0,_moment2.default)(dataset.start).format("YYYY-MM-DD")},_react2.default.createElement("div",{className:"day-number"},dayNumber),_react2.default.createElement("div",{className:"day-name"},dataset.weekday),_react2.default.createElement("div",{className:"event-container "+dataset.weekday},_react2.default.createElement("ul",{className:"alldays",style:alldaysHeight},alldays),_react2.default.createElement("ul",{className:"singles"},singles)))}}]),CalendarDay}(_react2.default.Component);exports.default=CalendarDay},201:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_calendarUpdate=__webpack_require__(208),_calendarUpdate2=_interopRequireDefault(_calendarUpdate),CalendarDetail=function(_React$Component){function CalendarDetail(props){_classCallCheck(this,CalendarDetail);var _this=_possibleConstructorReturn(this,(CalendarDetail.__proto__||Object.getPrototypeOf(CalendarDetail)).call(this,props));return _this.state={view:"detail",loading:!1,detail:{title:"",start:"",end:"",allday:!0,multiday:!1,category:{name:"",color:"",_id:""},user:{name:{first:"",last:""},username:"",_id:""},recursion:"once",note:""}},_this.switchView=_this.switchView.bind(_this),_this}return _inherits(CalendarDetail,_React$Component),_createClass(CalendarDetail,[{key:"componentDidMount",value:function(){var _this2=this;this.setState({loading:!0},function(){_jquery2.default.ajax({method:"GET",url:document.baseURI+"/events/?detail="+_this2.props.detail,dataType:"json"}).done(function(ev){ev.allday?(ev.start=(0,_moment2.default)(ev.start,"X"),ev.end&&(ev.end=(0,_moment2.default)(ev.end,"X"),(0,_moment2.default)(ev.start).isSame(ev.end,"day")||(ev.multiday=!0))):(ev.start=(0,_moment2.default)(ev.start,"X").subtract(2,"hours"),ev.end&&(ev.end=(0,_moment2.default)(ev.end,"X").subtract(2,"hours"))),_this2.setState({detail:ev,loading:!1})})})}},{key:"switchView",value:function(e){e.preventDefault(),this.setState({view:e.target.dataset.arg})}},{key:"render",value:function(){var detail=this.state.detail,currentView=void 0,updateButton=void 0,dateString=void 0,durationString=void 0;return detail.start&&detail.end&&detail.allday?(dateString=_react2.default.createElement("span",{className:"detail-time"},_react2.default.createElement("time",null,(0,_moment2.default)(detail.start).format("ddd. D MMMM YYYY"))," – ",_react2.default.createElement("time",null,(0,_moment2.default)(detail.end).format("ddd. D MMMM YYYY"))),durationString=_react2.default.createElement("small",{className:"detail-duration"},(0,_moment2.default)(detail.end).diff(detail.start,"days")+1," days")):detail.start&&!detail.end&&detail.allday?(dateString=_react2.default.createElement("span",{className:"detail-time"},_react2.default.createElement("time",null,(0,_moment2.default)(detail.start).format("ddd. D MMMM YYYY"))),durationString=_react2.default.createElement("small",{className:"detail-duration"},"1 day")):detail.start&&detail.end&&!detail.allday?(dateString=_react2.default.createElement("span",{className:"detail-time"},_react2.default.createElement("time",null,(0,_moment2.default)(detail.start).format("ddd. D MMMM YYYY"),", ",(0,_moment2.default)(detail.start).format("H:mm")," – ",(0,_moment2.default)(detail.end).format("H:mm"))),durationString=(0,_moment2.default)(detail.end).diff(detail.start,"minutes")>180?_react2.default.createElement("small",{className:"detail-duration"},(0,_moment2.default)(detail.end).diff(detail.start,"hours")," hours"):_react2.default.createElement("small",{className:"detail-duration"},(0,_moment2.default)(detail.end).diff(detail.start,"minutes")," minutes")):!detail.start||detail.end||detail.allday||(dateString=_react2.default.createElement("span",{className:"detail-time"},_react2.default.createElement("time",null,(0,_moment2.default)(detail.start).format("ddd. D MMMM YYYY"),", ",(0,_moment2.default)(detail.start).format("H:mm")))),"detail"==this.state.view&&(currentView=_react2.default.createElement("div",{className:"popup-body",style:{paddingTop:"2em"}},_react2.default.createElement("div",{className:"cat-stripe",style:{backgroundColor:detail.category.color}}),_react2.default.createElement("dl",{className:"detail-list"},_react2.default.createElement("div",{className:"dl-row"},_react2.default.createElement("dd",null,"Title"),_react2.default.createElement("dt",null,_react2.default.createElement("strong",null,detail.title))),_react2.default.createElement("div",{className:"dl-row"},_react2.default.createElement("dd",null,"Date"),_react2.default.createElement("dt",null,dateString," ",durationString)),_react2.default.createElement("div",{className:"dl-row"},_react2.default.createElement("dd",null,"Category"),_react2.default.createElement("dt",null,_react2.default.createElement("i",{style:{backgroundColor:detail.category.color}})," ",detail.category.name)),_react2.default.createElement("div",{className:"once"!=detail.recursion?"dl-row":"dl-row hide"},_react2.default.createElement("dd",null,"Recursion"),_react2.default.createElement("dt",{style:{textTransform:"capitalize"}},detail.recursion)),_react2.default.createElement("div",{className:detail.note?"dl-row":"dl-row hide"},_react2.default.createElement("dd",null,"Note"),_react2.default.createElement("dt",null,detail.note)),_react2.default.createElement("div",{className:"dl-row"},_react2.default.createElement("dd",null,"Author"),_react2.default.createElement("dt",null,detail.user.name.first," ",detail.user.name.last," ",_react2.default.createElement("small",null,(0,_moment2.default)(detail.added).fromNow())))))),"update"==this.state.view&&(currentView=_react2.default.createElement(_calendarUpdate2.default,{categories:this.props.categories,detail:this.state.detail,cancelPopup:this.props.cancelPopup,updateEvent:this.props.updateEvent})),((0,_jquery2.default)("#header-user").hasClass("publisher")||this.props.user._id==detail.user._id)&&(updateButton=_react2.default.createElement("div",{className:"update"==this.state.view?"active":"",onClick:this.switchView,"data-arg":"update"},"Update")),_react2.default.createElement("div",{id:"calendar-settings"},_react2.default.createElement("header",{className:"popup-header"},_react2.default.createElement("div",{className:"detail"==this.state.view?"active":"",onClick:this.switchView,"data-arg":"detail"},"Detail"),updateButton,_react2.default.createElement("div",{id:"close-popup",onClick:this.props.cancelPopup},"×")),currentView,_react2.default.createElement("div",{className:this.state.loading?"loading active":"loading"},_react2.default.createElement("div",{className:"spinner"})))}}]),CalendarDetail}(_react2.default.Component);exports.default=CalendarDetail},202:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_moment=__webpack_require__(1),CalendarFilter=(_interopRequireDefault(_moment),function(_React$Component){function CalendarFilter(props){_classCallCheck(this,CalendarFilter);var _this=_possibleConstructorReturn(this,(CalendarFilter.__proto__||Object.getPrototypeOf(CalendarFilter)).call(this,props));return _this.toggleFilter=_this.toggleFilter.bind(_this),_this}return _inherits(CalendarFilter,_React$Component),_createClass(CalendarFilter,[{key:"toggleFilter",value:function(e){e.preventDefault(),this.props.toggleFilter(e.target.id)}},{key:"render",value:function(){var _this2=this,categoryList=this.props.categories.map(function(cat){return _react2.default.createElement("li",{className:"category",key:cat.id},_react2.default.createElement("label",{className:_this2.props.catFilter.indexOf(cat.id)>-1?"checkbox active":"checkbox",onClick:_this2.toggleFilter,id:cat.id,title:cat.name,key:"filter-"+cat.id},_react2.default.createElement("i",{style:{backgroundColor:cat.color}})," ",cat.name))});return _react2.default.createElement("ul",{id:"calendar-filter"},categoryList,_react2.default.createElement("li",{className:"clear-filter",style:this.props.catFilter.length>0?{}:{display:"none"}},_react2.default.createElement("a",{href:"",onClick:this.toggleFilter,id:"clear"},"Clear filters")))}}]),CalendarFilter}(_react2.default.Component));exports.default=CalendarFilter},203:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),_fullcalendar=__webpack_require__(24),CalendarMinical=(_interopRequireDefault(_fullcalendar),function(_React$Component){function CalendarMinical(){return _classCallCheck(this,CalendarMinical),_possibleConstructorReturn(this,(CalendarMinical.__proto__||Object.getPrototypeOf(CalendarMinical)).apply(this,arguments))}return _inherits(CalendarMinical,_React$Component),_createClass(CalendarMinical,[{key:"componentDidMount",value:function(){var that=this,now=(0,_moment2.default)();(0,_jquery2.default)("#calendar-minical").fullCalendar({firstDay:1,header:{left:"",center:"prev title next",right:""},buttonIcons:!1,buttonText:{prev:"‹",next:"›"},dayNamesShort:["S","M","T","W","T","F","S"],dayClick:function(date,jsEvent,view){(0,_jquery2.default)("thead tr").removeClass("display-week"),(0,_jquery2.default)("thead td[data-date="+(0,_moment2.default)(date).format("YYYY-MM-DD")+"]").parent().addClass("display-week");var clickDate=(0,_moment2.default)(date).format("YYYY-MM-DD");that.props.setDate((0,_moment2.default)(clickDate,"YYYY-MM-DD"))},dayRender:function(date,cell){(0,_moment2.default)(date).isSame(that.props.date,"day")&&(0,_jquery2.default)("thead td[data-date="+(0,_moment2.default)(date).format("YYYY-MM-DD")+"]").parent().addClass("display-week"),(0,_moment2.default)(date).isSame(now,"day")&&(0,_jquery2.default)("thead td[data-date="+(0,_moment2.default)(date).format("YYYY-MM-DD")+"]").html("<span>"+(0,_moment2.default)(date).format("D")+"</span>")}})}},{key:"componentWillReceiveProps",value:function(nextProps){(0,_jquery2.default)("#calendar-minical").fullCalendar("gotoDate",nextProps.date),(0,_moment2.default)(nextProps.date).isSame(this.props.date,"week")||((0,_jquery2.default)("thead tr").removeClass("display-week"),(0,_jquery2.default)("thead td[data-date="+(0,_moment2.default)(nextProps.date).format("YYYY-MM-DD")+"]").parent().addClass("display-week"))}},{key:"render",value:function(){return _react2.default.createElement("div",{id:"calendar-minical"})}}]),CalendarMinical}(_react2.default.Component));exports.default=CalendarMinical},204:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__(19),_underscore2=_interopRequireDefault(_underscore),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),_fullcalendar=__webpack_require__(24),CalendarMonth=(_interopRequireDefault(_fullcalendar),function(_React$Component){function CalendarMonth(){return _classCallCheck(this,CalendarMonth),_possibleConstructorReturn(this,(CalendarMonth.__proto__||Object.getPrototypeOf(CalendarMonth)).apply(this,arguments))}return _inherits(CalendarMonth,_React$Component),_createClass(CalendarMonth,[{key:"componentDidMount",value:function(){var that=this,monthId=(0,_moment2.default)(this.props.date).format("YYYY-MM"),correctedEvents=((0,_moment2.default)(),this.props.events);correctedEvents.forEach(function(ev){ev.allday&&ev.end&&(ev.end=(0,_moment2.default)(ev.end).add(1,"days").format()),ev.allday||(ev.start=ev.start=(0,_moment2.default)(ev.start).format(),ev.end&&(ev.end=ev.end=(0,_moment2.default)(ev.end).format()))}),(0,_jquery2.default)("#"+monthId).fullCalendar({firstDay:1,header:!1,dayNamesShort:["SUN","MON","TUE","WED","THU","FRI","SAT"],events:function events(start,end,timezone,callback){var events=_underscore2.default.filter(correctedEvents,function(ev){return ev.visible});callback(events)},dayRender:function(date,cell){(0,_jquery2.default)(cell).prepend('<span class="bling"></span>')},eventRender:function(event,element){if(event.allday)(0,_jquery2.default)(element).addClass("allday"),(0,_jquery2.default)(element).css("background-color",event.category.color),(0,_jquery2.default)(element).attr("title",event.title);else{var time=(0,_moment2.default)(event.start).format("HH:mm");event.end&&(time=(0,_moment2.default)(event.start).format("HH:mm")+" – "+(0,_moment2.default)(event.end).format("HH:mm")),(0,_jquery2.default)(element).addClass("single"),(0,_jquery2.default)(element).prepend('<span class="category" style="background-color:'+event.category.color+'"></span><time>'+time+"</time>"),(0,_jquery2.default)(element).attr("title",time+", "+event.title)}},eventClick:function(event,jsEvent,view){that.props.setDetail(event._id),that.props.setPopup("detail")}}),(0,_jquery2.default)("#"+monthId).fullCalendar("gotoDate",that.props.date),setTimeout(function(){(0,_jquery2.default)("#calendar-monthly").css("min-height",(0,_jquery2.default)("#"+monthId).height())},1)}},{key:"componentWillReceiveProps",value:function(nextProps){var monthId=(0,_moment2.default)(this.props.date).format("YYYY-MM");(0,_jquery2.default)("#"+monthId).fullCalendar("refetchEvents"),setTimeout(function(){(0,_jquery2.default)("#calendar-monthly").css("min-height",(0,_jquery2.default)("#"+monthId).height())},1)}},{key:"render",value:function(){return _react2.default.createElement("div",{className:"calendar-month "+this.props.date.position,id:(0,_moment2.default)(this.props.date).format("YYYY-MM")})}}]),CalendarMonth}(_react2.default.Component));exports.default=CalendarMonth},205:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__(19),_underscore2=_interopRequireDefault(_underscore),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),_calendarMonth=__webpack_require__(204),_calendarMonth2=_interopRequireDefault(_calendarMonth),CalendarMonthly=function(_React$Component){function CalendarMonthly(props){_classCallCheck(this,CalendarMonthly);var _this=_possibleConstructorReturn(this,(CalendarMonthly.__proto__||Object.getPrototypeOf(CalendarMonthly)).call(this,props));return _this.state={dates:[],events:[]},_this}return _inherits(CalendarMonthly,_React$Component),_createClass(CalendarMonthly,[{key:"componentWillReceiveProps",value:function(nextProps){var _this2=this,dates=this.state.dates,oldDate=this.props.date,newDate=nextProps.date;_underscore2.default.isEqual(oldDate,newDate)&&this.props.events==nextProps.events||((0,_moment2.default)(newDate).isSame(oldDate,"month")?newDate.position=" same-month":(0,_moment2.default)(newDate).isBefore(oldDate)?newDate.position=" new-left":(0,_moment2.default)(newDate).isAfter(oldDate)&&(newDate.position=" new-right"),dates.push(newDate),this.setState({dates:dates},function(){if((0,_moment2.default)(oldDate).isSame(newDate,"month")){var newDates=_underscore2.default.reject(_this2.state.dates,function(date){return 0==date.position});return void _this2.setState({dates:newDates})}setTimeout(function(){(0,_moment2.default)(newDate).isBefore(oldDate)&&((0,_jquery2.default)(".calendar-month#"+(0,_moment2.default)(oldDate).format("YYYY-MM")).addClass("old-right"),(0,_jquery2.default)(".calendar-month#"+(0,_moment2.default)(newDate).format("YYYY-MM")).removeClass("new-left old-left new-right old-right")),(0,_moment2.default)(newDate).isAfter(oldDate)&&((0,_jquery2.default)(".calendar-month#"+(0,_moment2.default)(oldDate).format("YYYY-MM")).addClass("old-left"),(0,_jquery2.default)(".calendar-month#"+(0,_moment2.default)(newDate).format("YYYY-MM")).removeClass("new-left old-left new-right old-right"))},1),setTimeout(function(){var newDates=_underscore2.default.reject(_this2.state.dates,function(date){return(0,_moment2.default)(oldDate).isSame(date,"month")});_this2.setState({dates:newDates})},400)}))}},{key:"render",value:function(){var _this3=this,monthList=this.state.dates.map(function(date,index){var monthNum=(0,_moment2.default)(date).format("YYYY-MM");return _react2.default.createElement(_calendarMonth2.default,{date:date,events:_this3.props.events,key:monthNum,setPopup:_this3.props.setPopup,setDetail:_this3.props.setDetail})});return _react2.default.createElement("div",{id:"calendar-monthly"},monthList,_react2.default.createElement("div",{className:this.props.loading?"loader active":"loader"},_react2.default.createElement("div",{className:"spinner"})))}}]),CalendarMonthly}(_react2.default.Component);exports.default=CalendarMonthly},206:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_jquery=__webpack_require__(7),_moment=(_interopRequireDefault(_jquery),__webpack_require__(1)),_calendarFilter=(_interopRequireDefault(_moment),__webpack_require__(202)),_calendarFilter2=_interopRequireDefault(_calendarFilter),_calendarMinical=__webpack_require__(203),_calendarMinical2=_interopRequireDefault(_calendarMinical),_calendarYearcal=__webpack_require__(210),_calendarYearcal2=_interopRequireDefault(_calendarYearcal),CalendarSidebar=function(_React$Component){function CalendarSidebar(){return _classCallCheck(this,CalendarSidebar),_possibleConstructorReturn(this,(CalendarSidebar.__proto__||Object.getPrototypeOf(CalendarSidebar)).apply(this,arguments))}return _inherits(CalendarSidebar,_React$Component),_createClass(CalendarSidebar,[{key:"render",value:function(){var miniView=void 0,viewSwitch=void 0;return"weekly"==this.props.view?(miniView=_react2.default.createElement(_calendarMinical2.default,{date:this.props.date,setDate:this.props.setDate}),viewSwitch=_react2.default.createElement("a",{href:"",onClick:this.props.viewToggle},"Switch to ",_react2.default.createElement("u",null,"Monthly view"))):"monthly"==this.props.view&&(miniView=_react2.default.createElement(_calendarYearcal2.default,{date:this.props.date,setDate:this.props.setDate}),viewSwitch=_react2.default.createElement("a",{href:"",onClick:this.props.viewToggle
},"Switch to ",_react2.default.createElement("u",null,"Weekly view"))),_react2.default.createElement("aside",{id:"calendar-sidebar"},miniView,_react2.default.createElement(_calendarFilter2.default,{categories:this.props.categories,catFilter:this.props.catFilter,toggleFilter:this.props.toggleFilter}),_react2.default.createElement("div",{id:"calendar-viewtoggle"},viewSwitch))}}]),CalendarSidebar}(_react2.default.Component);exports.default=CalendarSidebar},207:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_underscore=__webpack_require__(19),_underscore2=_interopRequireDefault(_underscore),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),_calendarWeek=__webpack_require__(209),_calendarWeek2=_interopRequireDefault(_calendarWeek),CalendarStretch=function(_React$Component){function CalendarStretch(props){_classCallCheck(this,CalendarStretch);var _this=_possibleConstructorReturn(this,(CalendarStretch.__proto__||Object.getPrototypeOf(CalendarStretch)).call(this,props));return _this.state={dates:[],events:[]},_this}return _inherits(CalendarStretch,_React$Component),_createClass(CalendarStretch,[{key:"componentWillReceiveProps",value:function(nextProps){var _this2=this,dates=this.state.dates,oldDate=this.props.date,newDate=nextProps.date;_underscore2.default.isEqual(oldDate,newDate)&&this.props.events==nextProps.events||((0,_moment2.default)(newDate).isSame(oldDate,"isoWeek")?newDate.position=" same-week":(0,_moment2.default)(newDate).isBefore(oldDate)?newDate.position=" new-left":(0,_moment2.default)(newDate).isAfter(oldDate)&&(newDate.position=" new-right"),dates.push(newDate),this.setState({dates:dates},function(){if((0,_moment2.default)(oldDate).isSame(newDate,"isoWeek")){var newDates=_underscore2.default.reject(_this2.state.dates,function(date){return 0==date.position});return void _this2.setState({dates:newDates})}setTimeout(function(){(0,_moment2.default)(newDate).isBefore(oldDate)&&((0,_jquery2.default)(".week[data-week="+(0,_moment2.default)(oldDate).startOf("isoweek").format("YYYY-ww")+"]").addClass("old-right"),(0,_jquery2.default)(".week[data-week="+(0,_moment2.default)(newDate).startOf("isoweek").format("YYYY-ww")+"]").removeClass("new-left old-left new-right old-right")),(0,_moment2.default)(newDate).isAfter(oldDate)&&((0,_jquery2.default)(".week[data-week="+(0,_moment2.default)(oldDate).startOf("isoweek").format("YYYY-ww")+"]").addClass("old-left"),(0,_jquery2.default)(".week[data-week="+(0,_moment2.default)(newDate).startOf("isoweek").format("YYYY-ww")+"]").removeClass("new-left old-left new-right old-right"))},1),setTimeout(function(){var newDates=_underscore2.default.reject(_this2.state.dates,function(date){return(0,_moment2.default)(oldDate).isSame(date,"isoWeek")});_this2.setState({dates:newDates})},400)}))}},{key:"render",value:function(){var _this3=this,weekList=this.state.dates.map(function(date){var weekNum=(0,_moment2.default)(date).format("YYYY-ww");return _react2.default.createElement(_calendarWeek2.default,{date:date,events:_this3.props.events,key:weekNum,setPopup:_this3.props.setPopup,setDetail:_this3.props.setDetail})});return _react2.default.createElement("div",{id:"calendar-weekly"},weekList,_react2.default.createElement("div",{className:this.props.loading?"loader active":"loading"},_react2.default.createElement("div",{className:"spinner"})))}}]),CalendarStretch}(_react2.default.Component);exports.default=CalendarStretch},208:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),_jquery=__webpack_require__(7),_jquery2=_interopRequireDefault(_jquery),_fullcalendar=__webpack_require__(24),CalendarUpdate=(_interopRequireDefault(_fullcalendar),function(_React$Component){function CalendarUpdate(props){_classCallCheck(this,CalendarUpdate);var _this=_possibleConstructorReturn(this,(CalendarUpdate.__proto__||Object.getPrototypeOf(CalendarUpdate)).call(this,props));return _this.state={loading:!1,detail:{title:"",start:"",end:"",allday:!0,multiday:!1,category:"",recursion:"once",user:"",note:""}},_this.setDate=_this.setDate.bind(_this),_this.handleChange=_this.handleChange.bind(_this),_this.handleCheckbox=_this.handleCheckbox.bind(_this),_this.handleTime=_this.handleTime.bind(_this),_this.handleEndTime=_this.handleEndTime.bind(_this),_this.handleSubmit=_this.handleSubmit.bind(_this),_this.handleRemove=_this.handleRemove.bind(_this),_this}return _inherits(CalendarUpdate,_React$Component),_createClass(CalendarUpdate,[{key:"componentDidMount",value:function(){var that=this,detail=this.props.detail;detail.category=detail.category._id,detail.start=(0,_moment2.default)(detail.start),detail.end&&(detail.end=(0,_moment2.default)(detail.end)),this.setState({detail:detail},function(){(0,_jquery2.default)(".calendar-popupcal").fullCalendar({firstDay:1,header:{left:"",center:"prev title next",right:""},buttonIcons:!1,buttonText:{prev:"‹",next:"›"},dayNamesShort:["S","M","T","W","T","F","S"],dayRender:function(date,cell){(0,_jquery2.default)(cell).html("<span>"+(0,_moment2.default)(date).format("D")+"</span>"),that.state.detail.multiday?((0,_moment2.default)(date).isSame(that.state.detail.start,"day")&&(0,_jquery2.default)(cell).addClass("selected start"),(0,_moment2.default)(date).isSame(that.state.detail.end,"day")&&(0,_jquery2.default)(cell).addClass("selected end"),(0,_moment2.default)(date).isBetween(that.state.detail.start,that.state.detail.end)&&(0,_jquery2.default)(cell).addClass("selected")):(0,_moment2.default)(that.state.detail.start).isSame(date,"day")&&(0,_jquery2.default)(cell).addClass("selected start end")},dayClick:function(date,jsEvent,view){that.setDate(date)}})})}},{key:"setDate",value:function(date){function drawRange(start,end){for(var num=(0,_moment2.default)(end).diff(start,"days"),i=0;i<=num;i++)(0,_jquery2.default)(".fc-day[data-date="+(0,_moment2.default)(start).add(i,"days").format("YYYY-MM-DD")+"]").addClass("selected"),0==i&&(0,_jquery2.default)(".fc-day[data-date="+(0,_moment2.default)(start).add(i,"days").format("YYYY-MM-DD")+"]").addClass("start"),i==num&&(0,_jquery2.default)(".fc-day[data-date="+(0,_moment2.default)(start).add(i,"days").format("YYYY-MM-DD")+"]").addClass("end")}var _this2=this,detail=this.state.detail;(0,_jquery2.default)(".fc-day").removeClass("selected start end"),this.state.detail.multiday?((0,_moment2.default)(date).isBefore(this.state.detail.start)?detail.start=(0,_moment2.default)(date):(0,_moment2.default)(date).isBetween(this.state.detail.start,this.state.detail.end)?detail.start=(0,_moment2.default)(date):(0,_moment2.default)(date).isAfter(this.state.detail.start)&&(detail.end=(0,_moment2.default)(date)),this.setState({detail:detail},function(){drawRange(_this2.state.detail.start,_this2.state.detail.end)})):((0,_jquery2.default)(".fc-day[data-date="+(0,_moment2.default)(date).format("YYYY-MM-DD")+"]").addClass("selected start end"),detail.start=(0,_moment2.default)(date),detail.end="",this.setState({detail:detail}))}},{key:"handleChange",value:function(e){var detail=this.state.detail;detail[e.target.name]=e.target.value,this.setState({detail:detail})}},{key:"handleCheckbox",value:function(e){var _this3=this,detail=this.state.detail;(0,_jquery2.default)(e.target).hasClass("active")?detail[e.target.dataset.arg]=!1:detail[e.target.dataset.arg]=!0,1!=detail.multiday&&1!=this.state.detail.multiday||(detail.allday=!0),0!=detail.multiday&&0!=this.state.detail.multiday||(detail.end=""),1==detail.allday&&(detail.start=(0,_moment2.default)(this.state.detail.start).set({hour:0,minute:0})),this.setState({detail:detail},function(){0==detail.multiday&&_this3.setDate(_this3.state.detail.start)})}},{key:"handleTime",value:function(e){var detail=this.state.detail,time=Number(e.target.value);return"start-hours"==e.target.dataset.arg&&(detail.start=(0,_moment2.default)(detail.start).set("hour",time)),"start-minutes"==e.target.dataset.arg&&(detail.start=(0,_moment2.default)(detail.start).set("minute",time)),"end-hours"==e.target.dataset.arg&&(detail.end=(0,_moment2.default)(detail.end).set("hour",time)),"end-minutes"==e.target.dataset.arg&&(detail.end=(0,_moment2.default)(detail.end).set("minute",time)),(0,_moment2.default)(detail.end).isBefore(detail.start)?alert("Invalid time"):void this.setState({detail:detail})}},{key:"handleEndTime",value:function(e){var detail=this.state.detail;""==detail.end&&0==detail.allday?detail.end=(0,_moment2.default)(detail.start).add(1,"hours"):detail.end="",this.setState({detail:detail})}},{key:"handleSubmit",value:function(e){var _this4=this;return e.preventDefault(),""==this.state.detail.title?alert("Please enter a title"):""==this.state.detail.category?alert("Please supply a category"):void this.setState({loading:!0},function(){var ev=_this4.state.detail;ev.allday?(ev.start=(0,_moment2.default)(ev.start).format("X"),ev.end&&(ev.end=(0,_moment2.default)(ev.end).format("X"))):(ev.start=(0,_moment2.default)(ev.start).add(2,"hours").format("X"),ev.end&&(ev.end=(0,_moment2.default)(ev.end).add(2,"hours").format("X"))),ev.reason="update",_jquery2.default.ajax({method:"POST",url:"/humphrey/events",data:ev,dataType:"json"}).done(function(response){_this4.setState({loading:!1},function(){_this4.props.cancelPopup(),_this4.props.updateEvent(response)})})})}},{key:"handleRemove",value:function(e){e.preventDefault(),confirm("Are you sure?")}},{key:"render",value:function(){var ev=this.state.detail,hours=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],minutes=["00","05","10","15","20","25","30","35","40","45","50","55"],startHourList=hours.map(function(hour){return _react2.default.createElement("option",{value:hour,key:"sh-"+hour},hour)}),startMinuteList=minutes.map(function(minute){return _react2.default.createElement("option",{value:minute,key:"sm-"+minute},minute)}),endHourList=hours.map(function(hour){if(hour>=(0,_moment2.default)(ev.start).format("HH"))return _react2.default.createElement("option",{value:hour,key:"eh-"+hour},hour)}),endMinuteList=minutes.map(function(minute){return _react2.default.createElement("option",{value:minute,key:"em-"+minute},minute)}),catList=this.props.categories.map(function(cat){return _react2.default.createElement("option",{value:cat.id,key:cat.id},cat.name)});return _react2.default.createElement("div",{className:"popup-body"},_react2.default.createElement("form",null,_react2.default.createElement("div",{className:"form-row"},_react2.default.createElement("label",{htmlFor:"update-title"},"Title"),_react2.default.createElement("input",{type:"text",id:"update-title",name:"title",value:ev.title,onChange:this.handleChange})),_react2.default.createElement("div",{className:"form-row"},_react2.default.createElement("label",{htmlFor:"update-date"},"Date"),_react2.default.createElement("div",{className:"calendar"},_react2.default.createElement("div",{className:"calendar-popupcal"}),_react2.default.createElement("div",{className:"calendar-options"},_react2.default.createElement("label",{className:ev.allday?"checkbox active":"checkbox","data-arg":"allday",onClick:this.handleCheckbox},"All day"),_react2.default.createElement("label",{className:ev.multiday?"checkbox active":"checkbox","data-arg":"multiday",onClick:this.handleCheckbox},"Date range"),_react2.default.createElement("label",{className:ev.allday?"update-time disabled":"update-time",htmlFor:"update-time-start-hours"},"Start time"),_react2.default.createElement("div",{className:"set-time"},_react2.default.createElement("select",{id:"update-time-start-hours",onChange:this.handleTime,value:(0,_moment2.default)(ev.start).format("HH"),disabled:ev.allday,"data-arg":"start-hours"},startHourList),_react2.default.createElement("select",{id:"update-time-start-minutes",onChange:this.handleTime,value:(0,_moment2.default)(ev.start).format("mm"),disabled:ev.allday,"data-arg":"start-minutes"},startMinuteList)),_react2.default.createElement("label",{className:ev.allday?"checkbox disabled":""!=ev.end?"checkbox active":"checkbox",htmlFor:"update-time-end-hours",onClick:this.handleEndTime},"End time"),_react2.default.createElement("div",{className:"set-time"},_react2.default.createElement("select",{id:"update-time-end-hours",onChange:this.handleTime,value:(0,_moment2.default)(ev.end).format("HH"),disabled:1==ev.allday||""==ev.end,"data-arg":"end-hours"},endHourList),_react2.default.createElement("select",{id:"update-time-end-minutes",onChange:this.handleTime,value:(0,_moment2.default)(ev.end).format("mm"),disabled:1==ev.allday||""==ev.end,"data-arg":"end-minutes"},endMinuteList)),_react2.default.createElement("label",{className:"update-time",htmlFor:"update-recursion"},"Recursion"),_react2.default.createElement("div",{className:"set-time"},_react2.default.createElement("select",{id:"update-recursion",name:"recursion",value:ev.recursion,onChange:this.handleChange},_react2.default.createElement("option",{value:"once"},"Once"),_react2.default.createElement("option",{value:"monthly"},"Monthly"),_react2.default.createElement("option",{value:"yearly"},"Yearly")))))),_react2.default.createElement("div",{className:"form-row"},_react2.default.createElement("label",{htmlFor:"update-category"},"Category"),_react2.default.createElement("select",{id:"update-category",name:"category",value:ev.category,onChange:this.handleChange},catList)),_react2.default.createElement("div",{className:"form-row"},_react2.default.createElement("label",{htmlFor:"update-note"},"Note"),_react2.default.createElement("textarea",{id:"update-note",name:"note",value:ev.note,onChange:this.handleChange})),_react2.default.createElement("button",{className:"button",type:"submit",onClick:this.handleSubmit},"Update"),_react2.default.createElement("a",{href:"",className:"link",onClick:this.handleRemove},"Remove")),_react2.default.createElement("div",{className:this.state.loading?"loading active":"loading"},_react2.default.createElement("div",{className:"spinner"})))}}]),CalendarUpdate}(_react2.default.Component));exports.default=CalendarUpdate},209:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),_underscore=__webpack_require__(19),_underscore2=_interopRequireDefault(_underscore),_calendarDay=__webpack_require__(200),_calendarDay2=_interopRequireDefault(_calendarDay),CalendarWeek=function(_React$Component){function CalendarWeek(){return _classCallCheck(this,CalendarWeek),_possibleConstructorReturn(this,(CalendarWeek.__proto__||Object.getPrototypeOf(CalendarWeek)).apply(this,arguments))}return _inherits(CalendarWeek,_React$Component),_createClass(CalendarWeek,[{key:"render",value:function(){function happensToday(ev,day){return!!(0,_moment2.default)(ev.start).isBetween(day.start,day.end)||(!(!ev.end||!(0,_moment2.default)(ev.end).isBetween(day.start,day.end))||(!!(ev.end&&(0,_moment2.default)(ev.start).isBefore(day.start)&&(0,_moment2.default)(ev.end).isAfter(day.end))||(!ev.end||!(0,_moment2.default)(ev.end).isBefore(day.start))&&(!(0,_moment2.default)(ev.start).isAfter(day.end)&&void 0)))}var _this2=this,startWeek=(0,_moment2.default)(this.props.date).startOf("isoWeek"),weekdays=[{name:"mon",column:[]},{name:"tue",column:[]},{name:"wed",column:[]},{name:"thu",column:[]},{name:"fri",column:[]},{name:"wkd",column:[]}],events=_underscore2.default.filter(this.props.events,function(ev){return ev.visible});events=_underscore2.default.sortBy(events,"start");var x=void 0;for(x in events)if(1==events[x].allday){events[x].pos=-1;var day=void 0,i=void 0;for(i in weekdays)if(day={start:(0,_moment2.default)(startWeek).add(i,"days").startOf("day").format(),end:(0,_moment2.default)(startWeek).add(i,"days").endOf("day").format()},"wkd"==weekdays[i].name&&(day.end=(0,_moment2.default)(startWeek).add(6,"days").endOf("day").format()),events[x].pos>-1)weekdays[i].column[events[x].pos]=happensToday(events[x],day)?events[x]._id:"empty";else if(happensToday(events[x],day)){var fill=!1,j=void 0;for(j in weekdays[i].column)events[x].pos==-1&&"empty"==weekdays[i].column[j]&&(weekdays[i].column[j]=events[x]._id,events[x].pos=j,fill=!0);0==fill&&(weekdays[i].column.push(events[x]._id),events[x].pos=weekdays[i].column.indexOf(events[x]._id))}else weekdays[i].column.push("empty")}events=_underscore2.default.sortBy(events,"pos");var dataset=weekdays.map(function(weekday,index){var day={start:(0,_moment2.default)(startWeek).add(index,"days").startOf("day").format(),end:(0,_moment2.default)(startWeek).add(index,"days").endOf("day").format(),weekday:weekday.name,alldays:[],singles:[]};return"wkd"==weekday.name&&(day.end=(0,_moment2.default)(startWeek).add(6,"days").endOf("day").format()),events.forEach(function(ev){(0,_moment2.default)(ev.start).isBetween(day.start,day.end)&&(ev.allday&&day.alldays.push(ev),ev.allday||day.singles.push(ev)),ev.allday&&ev.end&&((0,_moment2.default)(ev.end).isBetween(day.start,day.end)?day.alldays.push(ev):(0,_moment2.default)(ev.start).isBefore(day.start)&&(0,_moment2.default)(ev.end).isAfter(day.end)&&day.alldays.push(ev))}),day}),weekList=dataset.map(function(day,index){return _react2.default.createElement(_calendarDay2.default,{dataset:day,key:(0,_moment2.default)(day.start).format(),setPopup:_this2.props.setPopup,setDetail:_this2.props.setDetail})});return _react2.default.createElement("ul",{className:"week "+this.props.date.position,"data-week":(0,_moment2.default)(startWeek).format("YYYY-ww")},weekList)}}]),CalendarWeek}(_react2.default.Component);exports.default=CalendarWeek},210:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(8),_react2=_interopRequireDefault(_react),_moment=__webpack_require__(1),_moment2=_interopRequireDefault(_moment),CalendarYearcal=function(_React$Component){function CalendarYearcal(props){_classCallCheck(this,CalendarYearcal);var _this=_possibleConstructorReturn(this,(CalendarYearcal.__proto__||Object.getPrototypeOf(CalendarYearcal)).call(this,props));return _this.state={year:"",month:""},_this.navYear=_this.navYear.bind(_this),_this.clickMonth=_this.clickMonth.bind(_this),_this}return _inherits(CalendarYearcal,_React$Component),_createClass(CalendarYearcal,[{key:"componentDidMount",value:function(){this.setState({year:(0,_moment2.default)(this.props.date).format("YYYY"),month:(0,_moment2.default)(this.props.date).format("MM")})}},{key:"componentWillReceiveProps",value:function(nextProps){this.setState({year:(0,_moment2.default)(nextProps.date).format("YYYY"),month:(0,_moment2.default)(nextProps.date).format("MM")})}},{key:"navYear",value:function(e){e.preventDefault();var newYear=(0,_moment2.default)(this.state.year,"YYYY").add(1,"years").format("YYYY");"prev"==e.target.dataset.arg&&(newYear=(0,_moment2.default)(this.state.year,"YYYY").subtract(1,"years").format("YYYY")),this.setState({year:newYear})}},{key:"clickMonth",value:function(e){e.preventDefault(),this.props.setDate((0,_moment2.default)(e.target.dataset.month,"YYYY-MM"))}},{key:"render",value:function(){var viewYear=(0,_moment2.default)(this.props.date).format("YYYY"),now=(0,_moment2.default)().format("YYYY-MM");return _react2.default.createElement("div",{id:"calendar-yearcal"},_react2.default.createElement("header",null,_react2.default.createElement("a",{href:"",onClick:this.navYear,"data-arg":"prev"},"‹"),this.state.year,_react2.default.createElement("a",{href:"",onClick:this.navYear,"data-arg":"next"},"›")),_react2.default.createElement("ul",{id:"yearcal-months",className:this.state.year==viewYear?"this-year":""},_react2.default.createElement("li",{className:"01"==this.state.month?"active":"","data-today":now==this.state.year+"-01"?"yay":"nope","data-month":this.state.year+"-01",onClick:this.clickMonth},"JAN"),_react2.default.createElement("li",{className:"02"==this.state.month?"active":"","data-today":now==this.state.year+"-02"?"yay":"nope","data-month":this.state.year+"-02",onClick:this.clickMonth},"FEB"),_react2.default.createElement("li",{className:"03"==this.state.month?"active":"","data-today":now==this.state.year+"-03"?"yay":"nope","data-month":this.state.year+"-03",onClick:this.clickMonth},"MAR"),_react2.default.createElement("li",{className:"04"==this.state.month?"active":"","data-today":now==this.state.year+"-04"?"yay":"nope","data-month":this.state.year+"-04",onClick:this.clickMonth},"APR"),_react2.default.createElement("li",{className:"05"==this.state.month?"active":"","data-today":now==this.state.year+"-05"?"yay":"nope","data-month":this.state.year+"-05",onClick:this.clickMonth},"MAY"),_react2.default.createElement("li",{className:"06"==this.state.month?"active":"","data-today":now==this.state.year+"-06"?"yay":"nope","data-month":this.state.year+"-06",onClick:this.clickMonth},"JUN"),_react2.default.createElement("li",{className:"07"==this.state.month?"active":"","data-today":now==this.state.year+"-07"?"yay":"nope","data-month":this.state.year+"-07",onClick:this.clickMonth},"JUL"),_react2.default.createElement("li",{className:"08"==this.state.month?"active":"","data-today":now==this.state.year+"-08"?"yay":"nope","data-month":this.state.year+"-08",onClick:this.clickMonth},"AUG"),_react2.default.createElement("li",{className:"09"==this.state.month?"active":"","data-today":now==this.state.year+"-09"?"yay":"nope","data-month":this.state.year+"-09",onClick:this.clickMonth},"SEP"),_react2.default.createElement("li",{className:"10"==this.state.month?"active":"","data-today":now==this.state.year+"-10"?"yay":"nope","data-month":this.state.year+"-10",onClick:this.clickMonth},"OCT"),_react2.default.createElement("li",{className:"11"==this.state.month?"active":"","data-today":now==this.state.year+"-11"?"yay":"nope","data-month":this.state.year+"-11",onClick:this.clickMonth},"NOV"),_react2.default.createElement("li",{className:"12"==this.state.month?"active":"","data-today":now==this.state.year+"-12"?"yay":"nope","data-month":this.state.year+"-12",onClick:this.clickMonth},"DEC")))}}]),CalendarYearcal}(_react2.default.Component);exports.default=CalendarYearcal}});